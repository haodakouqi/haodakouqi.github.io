(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21e014"],{d45c:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user-manage"},[n("div",{staticClass:"button-group"},[n("span",{staticClass:"route-name"},[t._v(t._s(t.$route.meta.title))]),n("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-plus"},on:{click:t.handleAdd}},[t._v("添加")])],1),n("el-row",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.dataList,stripe:"",size:"mini"}},[n("el-table-column",{attrs:{prop:"tenant.tenantId",label:"租户ID"}}),n("el-table-column",{attrs:{prop:"tenant.tenantName",label:"租户名称"}}),n("el-table-column",{attrs:{label:"租户管理员"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.userList,(function(e,a){return n("span",{key:a,staticStyle:{"margin-right":"6px"}},[t._v(t._s(e.userId))])}))}}])}),n("el-table-column",{attrs:{prop:"tenant.tenantDesc",label:"租户描述"}}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(n){return t.handleEdit(e.row)}}},[t._v("编辑")]),n("el-button",{staticClass:"btn-text-red",attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return t.handleDelete(e.row)}}},[t._v("删除\n          ")])]}}])})],1),n("el-pagination",{attrs:{"current-page":t.current,"page-sizes":[10,20,50,100],"page-size":t.page,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),n("el-dialog",{attrs:{title:t.handleTitle,visible:t.handleVisible,width:"500px",center:""},on:{"update:visible":function(e){t.handleVisible=e}}},[n("el-form",{ref:"addForm",attrs:{model:t.addForm,rules:t.rules,"status-icon":"","label-width":"100px",size:"small"}},[n("el-form-item",{attrs:{label:"租户ID:",prop:"tenantId"}},[n("el-input",{attrs:{disabled:"修改租户"===t.handleTitle,maxlength:"50",type:"text"},model:{value:t.addForm.tenantId,callback:function(e){t.$set(t.addForm,"tenantId","string"===typeof e?e.trim():e)},expression:"addForm.tenantId"}})],1),n("el-form-item",{attrs:{label:"租户名称:",prop:"tenantName"}},[n("el-input",{attrs:{maxlength:"50",type:"text"},model:{value:t.addForm.tenantName,callback:function(e){t.$set(t.addForm,"tenantName","string"===typeof e?e.trim():e)},expression:"addForm.tenantName"}})],1),n("el-form-item",{attrs:{label:"租户管理员:",prop:"tenantAdmin"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择",clearable:""},model:{value:t.addForm.tenantAdmin,callback:function(e){t.$set(t.addForm,"tenantAdmin",e)},expression:"addForm.tenantAdmin"}},t._l(t.userDataList,(function(t){return n("el-option",{key:t.username,attrs:{label:t.name,value:t.username}})})),1)],1),n("el-form-item",{attrs:{label:"租户描述",prop:"tenantDesc"}},[n("el-input",{attrs:{maxlength:"50",rows:3,type:"textarea"},model:{value:t.addForm.tenantDesc,callback:function(e){t.$set(t.addForm,"tenantDesc","string"===typeof e?e.trim():e)},expression:"addForm.tenantDesc"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleConfirm}},[t._v("确 定")]),n("el-button",{attrs:{size:"small"},on:{click:function(e){t.handleVisible=!1}}},[t._v("取 消")])],1)],1)],1)},r=[],i=(n("5ab2"),n("6d57"),n("e10e"),n("4ca4")),l=n("08c1"),s=n("365c"),o=n("f753"),d=n.n(o);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var m=function(t,e,n){d()({method:"get",url:s["a"].checkTenantId,params:{tenantId:e}}).then((function(t){t.data?n(new Error("该ID已经存在")):n()}))},p={data:function(){return{handleTitle:"",handleVisible:!1,delVisible:!1,current:1,page:10,total:10,tableLoading:!0,addForm:{tenantId:"",tenantName:"",tenantDesc:"",tenantAdmin:[]},defaultForm:{tenantId:"",tenantName:"",tenantDesc:"",tenantAdmin:[]},rules:{tenantId:[],tenantAdmin:[{type:"array",required:!0,message:"请选择租户管理员",trigger:"change"}]},addRules:[{required:!0,message:"请输入租户ID",trigger:"blur"},{validator:m,trigger:"blur"},{pattern:/^[a-zA-Z0-9_\-\\.$][a-zA-Z0-9_\-\s\\.@\\$]+$/,message:"由字母、数字、符号[_-.]组成",trigger:"blur"}],delId:""}},created:function(){this.getData(),this.getSonicUserList(this)},computed:u({},Object(l["e"])({dataList:function(t){return t.platform.tenantlist},userDataList:function(t){return t.platform.userList}}),{addTenantForm:{get:function(){var t={tenant:{},userList:{}};return t.tenant.tenantId=this.addForm.tenantId,t.tenant.tenantName=this.addForm.tenantName,t.tenant.tenantDesc=this.addForm.tenantDesc,t.userList=this.addForm.tenantAdmin.map((function(t){return{role:1,userId:t}})),t}}}),methods:u({},Object(l["b"])("platform",["getTenantList","addTenant","editTenant","delTenant","getSonicUserList"]),{getData:function(){var t=this;t.getTenantList(t)},handleSizeChange:function(t){this.pageSize=t,this.getData()},handleCurrentChange:function(t){this.current=t,this.getData()},handleAdd:function(){var t=this;this.rules.tenantId=this.addRules,this.handleTitle="添加租户",this.handleVisible=!0,this.addForm=Object.assign({},this.defaultForm),this.$nextTick((function(){t.$refs.addForm.clearValidate()}))},handleEdit:function(t){var e=this;this.rules.tenantId=[],this.handleTitle="修改租户",this.handleVisible=!0,this.$nextTick((function(){e.$refs.addForm.clearValidate(),e.addForm={tenantId:t.tenant.tenantId,tenantName:t.tenant.tenantName,tenantDesc:t.tenant.tenantDesc,tenantAdmin:t.userList.map((function(t){return t.userId}))}}))},handleConfirm:function(){var t=this;this.$refs["addForm"].validate((function(e){if(!e)return!1;var n=t;"修改租户"===n.handleTitle?n.editTenant(n):n.addTenant(n),n.handleVisible=!1}))},handleDelete:function(t){var e=this;this.delId=t.tenant.tenantId,this.$confirm("删除不可恢复，是否确定删除?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((function(){e.delTenant(e),e.delVisible=!1})).catch((function(){e.$message.info("取消删除")}))}})},h=p,f=n("5511"),b=Object(f["a"])(h,a,r,!1,null,null,null);e["default"]=b.exports}}]);